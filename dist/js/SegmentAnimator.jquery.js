var INHANCE_SegmentAnimator=function(){"use strict";return{Animator:function(i,t){this.animRef,this.imgs,this.canvas=$(i)[0],this.ctx=this.canvas.getContext("2d"),this.params=t,this.params.onInit,this.cnt=0,this.curTime=0,this.fps=t.fps||25,this.isPlaying=!1,this.init=function(){var i=this.params.frames;this.imgs=new Array(i);for(var t=this,s=0;s<this.params.frames;s++){var n=this.params.naming.match(/#/g).join(""),a=n.replace(/#/g,"0"),h=this.params.naming.replace(n,(a.substring(1)+s).slice(-1*a.length)),e=new Image;e.id=s,$(e).on("load error",function(s){$(this).off(),"load"==s.type&&(t.imgs[this.id]=this),--i<=0&&"function"==typeof t.params.onInit&&(t.params.onInit(),t.imgs=t.imgs.filter(function(i){return null!=i}),console.log(t.imgs))}),e.src=h}},this.playAnim=function(i,t,s,n){this.isPlaying&&this.pauseAnim(),this.start=i||this.cnt,this.cnt=0,this.end=Math.min(t||this.imgs.length-1,this.imgs.length-1),this.isLoop=s,this.callback=n,this.doAnim(this.curTime=window.performance&&window.performance.now?window.performance.now():+new Date)},this.doAnim=function(i){this.isPlaying=!0;var t=(i-this.curTime)/1e3;this.cnt+=t*this.fps;var s=Math.max(Math.floor(this.cnt+this.start),0);if(s>this.end&&(this.cnt=0,s=this.start,!this.isLoop))return cancelAnimationFrame(this.animRef),void("function"==typeof this.callback&&this.callback());this.animRef=requestAnimationFrame(this.doAnim.bind(this)),this.curTime=i;var n=this.imgs[s];this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);try{this.ctx.drawImage(n,0,0,n.width,n.height,0,0,this.canvas.width,this.canvas.height)}catch(i){console.log(i,s,n)}},this.pauseAnim=function(){cancelAnimationFrame(this.animRef),this.isPlaying=!1},this.clean=function(){console.log("cleanAnim"),this.isPlaying&&this.pauseAnim(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},this.destroy=function(){this.isPlaying&&this.clean(),this.imgs.length=0},this.init()}}}();
